coffeecup = require 'coffeecup'
#fs = require 'fs'
express = require 'express'

app = express()

app.set 'views', "#{__dirname}/webroot"
app.engine 'coffee', coffeecup.__express
app.set 'view engine', 'coffee'
#app.engine 'coffee', coffeecup.adapters.express.compile #require('coffeecup').__express

app.get '/', (req, res) ->
  res.render 'index'

server = app.listen 80, ->
    console.log "Listening on port #{server.address().port}"

###
helpers = {}
helpers["_#{f.slice 0, -3}"] = require "./include/#{f}" for f in fs.readdirSync('./include') when f.slice(-3) is ".js"

app.get "/upload", (req, res) ->
	res.writeHead 200, "Content-Type": "text/plain"
	res.write "File successfully uploaded\n"
	res.end()

file = coffeecup.render template, empty: '', hardcode: helpers
###
